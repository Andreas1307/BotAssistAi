<script>
  const params = new URLSearchParams(window.location.search);
  const target = params.get("target");
  const shop = params.get("shop");

  // âœ… Listen for messages from iframe (Shopify admin)
  window.addEventListener("message", (event) => {
    try {
      const data = JSON.parse(event.data);
      if (data.event === "redirect" && data.target) {
        console.log("ðŸªŸ redirect.html received message:", data.target);
        window.location.href = data.target;
      }
    } catch {}
  });

  // âœ… If opened directly (not via message)
  if (target) {
    window.location.href = decodeURIComponent(target);
  } else if (shop) {
    window.location.href = `https://${shop}/admin/apps/botassistai?shop=${shop}`;
  } else {
    window.location.href = "https://botassistai.com/";
  }
</script>