<!DOCTYPE html>
<html>
<head><meta charset="utf-8"/><title>Redirecting…</title></head>
<body style="text-align:center;margin-top:30vh;font-family:sans-serif">
  <h3>Redirecting…</h3>
  <script>
    const params = new URLSearchParams(window.location.search);
    const shop = params.get("shop");
    const install = params.get("install");
    const target = params.get("target");

    if (install && shop) {
      // first time install: go to your OAuth start
      const authUrl = `https://api.botassistai.com/shopify/auth?shop=${encodeURIComponent(shop)}`;
      console.log("➡️ Redirecting to auth:", authUrl);
      window.top.location.href = authUrl; // now allowed (we're top-level)
    } else if (target) {
      // general case
      window.top.location.href = decodeURIComponent(target);
    } else if (shop) {
      window.top.location.href = `https://${shop}/admin/apps/botassistai?shop=${shop}`;
    } else {
      window.top.location.href = "https://botassistai.com/";
    }
  </script>
</body>
</html>
