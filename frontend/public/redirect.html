<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting…</title>
  </head>
  <body style="text-align:center;margin-top:30vh;font-family:sans-serif">
    <h3>Redirecting…</h3>
    <script>
      const params = new URLSearchParams(location.search);
      const target = params.get("target");
      const shop = params.get("shop");
      const host = params.get("host");

      const go = (url) => setTimeout(() => location.replace(url), 100);

      if (target) {
        go(decodeURIComponent(target));
      } else if (shop) {
        const safeHost = host || btoa(`${shop}/admin`);
        go(`https://${shop}/admin/apps/botassistai?shop=${shop}&host=${safeHost}`);
      } else {
        go("https://botassistai.com/");
      }
    </script>
  </body>
</html>
