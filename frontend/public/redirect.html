<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Redirecting…</title>
  </head>
  <body style="text-align:center;margin-top:30vh;font-family:sans-serif">
    <h3>Redirecting…</h3>
    <script>
      const params = new URLSearchParams(window.location.search);
      const shop = params.get("shop");
      const install = params.get("install");
      const target = params.get("target");
    
      if (install && shop) {
        // ✅ This runs in *your own* domain, safe to break out
        const authUrl = `https://api.botassistai.com/shopify/auth?shop=${encodeURIComponent(shop)}`;
        console.log("➡️ Redirecting to OAuth:", authUrl);
        window.top.location.href = authUrl;
      } else if (target) {
        const decoded = decodeURIComponent(target);
        console.log("➡️ Redirecting to:", decoded);
        window.top.location.href = decoded;
      } else if (shop) {
        const fallback = `https://${shop}/admin/apps/botassistai?shop=${shop}`;
        console.log("➡️ Redirecting fallback to:", fallback);
        window.top.location.href = fallback;
      } else {
        window.top.location.href = "https://botassistai.com/";
      }
    </script>
    
  </body>
</html>
