<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Redirecting…</title>
</head>
<body style="text-align:center;margin-top:30vh;font-family:sans-serif">
  <h3>Redirecting…</h3>
  <script>
    const params = new URLSearchParams(location.search);
    const shop = params.get("shop");
    const host = params.get("host");
    const target = params.get("target");

    if (target) {
      // Direct external target (billing confirmation, etc.)
      window.location.replace(decodeURIComponent(target));
    } else if (shop) {
      // ✅ Construct safe fallback host if missing
      const safeHost = host || btoa(`${shop}/admin`);
      window.location.replace(
        `https://${shop}/admin/apps/YOUR_APP_HANDLE?shop=${shop}&host=${safeHost}`
      );
    } else {
      // ❌ No shop info — fallback to homepage
      window.location.replace("https://botassistai.com/");
    }
  </script>
</body>
</html>
